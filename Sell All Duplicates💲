import wmi
import ctypes

def set_volume_serial(drive_letter, new_serial):
    c = wmi.WMI()
    for disk in c.Win32_LogicalDisk():
        if disk.DeviceID == f"{drive_letter}:":
            print(f"Current Volume Serial Number: {disk.VolumeSerialNumber}")
            break

    # This operation requires administrative privileges
    if not ctypes.windll.shell32.IsUserAnAdmin():
        print("Please run this script with administrative privileges.")
        return

    # Using the 'Volumeid' tool to change volume serial number
    command = f'Volumeid {drive_letter}: {new_serial}'
    result = ctypes.windll.shell32.ShellExecuteW(None, "runas", "cmd.exe", f"/c {command}", None, 1)
    
    if result <= 32:
        print("Failed to change volume serial number. Make sure you have the Volumeid tool.")
    else:
        print("Volume serial number changed successfully.")

def main():
    drive_letter = "C"
    new_serial = "1234-5678"
    
    set_volume_serial(drive_letter, new_serial)

if __name__ == "__main__":
    main()
